<!doctype html>
<html lang="en">

<!-- Mirrored from new.uouapps.com/tiger-html/user-dashboard(followers).html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 29 May 2018 08:12:17 GMT -->
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>TIGER - Social Network HTML Template</title>

<!-- Fonts Online -->
<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700,800,300' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>


<!-- Style Sheet -->
<link rel="stylesheet" href="css/owl.carousel.css">
<link rel="stylesheet" href="css/main-style.css">
<link rel="stylesheet" href="css/style.css">

<!--collapse stylesheet-->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">


<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<style>
  .list-group-item{
    display: table-row-group;
  }
  #pagination-container ul {
      list-style-type: none;
      margin: 0;
      /*padding-left: 40px;*/
      overflow: hidden;
      background-color: #fff;
  }

  #pagination-container li {
      float: left;
      padding: 10px
  }
    .img-item{
        padding: 10px;
        text-align: center;
        border: 1px solid #abafaf;
        /* padding: 18px; */
        border-radius: 16px;
        /* margin-right: -4px; */

    }
    .uploaded-date{
        color: #909294;
        margin-top: -15px;
        font-size: 11px;
    }
</style>

</head>

<body>
<div id="main-wrapper"> 
  
  <!-- Top Toolbar -->
  <div class="toolbar">
  </div>
  <!-- end toolbar -->
  
  <div class="box-shadow-for-ui">
    <div class="uou-block-2b">
      <div class="container"> <a href="#" class="logo"><img src="images/logo.png" alt=""></a> <a href="#" class="mobile-sidebar-button mobile-sidebar-toggle"><span></span></a>
        <nav class="nav">
          <ul class="sf-menu">
            <li><a href="index-2.html"><i class="fa  fa-home"></i></a></li>
            <li> <a href="listing-filter.html">Professionals</a> </li>
            <li class="active"> <a href="index-2.html">Pages</a>
              <ul>
                <li><a href="profile_company.html">Profile Company</a></li>
                <li><a href="profile_company-no-tabs.html">Profile Company No Tabs</a></li>
                <li><a href="user-dashboard(connections)(hotkeys-disabled).html">User Dashboard 1</a></li>
                <li><a href="user-dashboard(connections)(hotkeys-enabled).html">User Dashboard 2</a></li>
                <li><a href="user-dashboard(followers).html">User Dashboard 3</a></li>
                <li><a href="user-dashboard(following).html">User Dashboard 4</a></li>
                <li><a href="blog-post.html">Blog Post</a></li>                
              </ul>
            </li>
            <li> <a href="user-profile(layout-1).html">User Profile</a></li>
            <li><a href="blog.html">Blog</a></li>
            <li><a href="gui-kit.html">GUI KIT</a></li>
          </ul>
        </nav>
      </div>
    </div>
    <!-- end .uou-block-2b --> 
  </div>
  <!-- end .uou-block-2b -->

  <!-- SUB Banner -->
  <div class="profile-bnr sub-bnr user-profile-bnr">
    <div class="position-center-center">
      <div class="container">
        <h2 id="projectName">Go Green 9.1</h2>
      </div>
    </div>
  </div>
  

  <!-- Compny Profile -->
  <div class="compny-profile"> 
    
    <!-- Profile Company Content -->
    <div class="profile-company-content has-bg-image" data-bg-color="f5f5f5">
      <div class="container">
        <div class="row"> 
          
          <!-- SIDE BAR -->
          <div class="col-md-4"> 
            <!-- Company Information -->
            <div class="sidebar">
              <!--<h5 class="main-title">Mike Tomlinson</h5>-->
              <div class="sidebar-thumbnail"> <img src="images/med-avatar.jpg" alt=""> </div>
              <div class="sidebar-information">
                <ul class="single-category">
                  <li class="row">
                    <h6 class="title col-xs-6">Team Leader</h6>
                    <span class="subtitle col-xs-6" id="teamLeader">Chapa Karunanayaka</span> </li>
                  <li class="row">
                    <h6 class="title col-xs-6">OC members</h6>
                    <span class="subtitle col-xs-6">
                      <ul style="list-style-type: none" id="ocMembers">
                        <li>Dulanji</li>
                        <li>Ishara</li>
                        <li>Gothamee</li>
                      </ul>
                    </span> </li>
                  <li class="row">
                    <h6 class="title col-xs-6" >Start Date</h6>
                    <span class="subtitle col-xs-6" id="startDate">2017/08/22</span> </li>
                  <li class="row">
                    <h6 class="title col-xs-6">End Date</h6>
                    <span class="subtitle col-xs-6" id="endDate">2017/10/20</span> </li>
                  <li class="row">
                    <h6 class="title col-xs-6">Description</h6>
                    <span class="subtitle col-xs-6" id="description">Related to Environmental conservation and waste management. 8 foriegn interns works under this project.</span> </li>
                  <!--<li class="row">
                    <h6 class="title col-xs-6">Operating Hours</h6>
                    <span class="subtitle col-xs-6">10:00 AM - 5:00 PM</span> </li>
                  <li class="row">
                    <h6 class="title col-xs-6">Contacts</h6>
                    <div class="col-xs-6"> <span class="subtitle">*****************<i class="fa fa-exclamation-circle"></i></span> <span class="subtitle">***************** <i class="fa fa-exclamation-circle"></i></span> <a href="#.">example@example.com</a> <a href="#.">example.com</a> </div>
                  </li>-->
                </ul>
              </div>
              <br>
              <br>

              <div id="projectCommentContainer">
                <div class="col-sm-2 text-right">
                  <img src="images/med-avatar.jpg" class="img-circle" height="65" width="65" alt="Avatar">
                </div>
                <div class="col-sm-10">
                  <h5>Anja <small>Sep 29, 2015, 9:12 PM</small></h5>
                  <p>good job!</p>
                  <br>
                </div>
              </div>
                <div class="project-comments">
                  <form>
                    <div class="form-group">
                      <div class="col-md-8">
                        <textarea class="form-control" rows="1" id="projectComment" placeholder="your comments"></textarea>
                      </div>
                      <div class="col-md-2">
                        <button type="button" class="btn btn-success" id="projectCommentBtn">Comment</button>
                      </div>
                                        
                    </div>
                  </form>
                </div>

              </div>
          </div>
          
          <!-- Tab Content -->
          <div class="col-md-8">
            <div class="network">
              <!--<h4>Network</h4>-->
              
              <!-- Nav Tabs -->
              <ul class="nav nav-tabs">
                <li><a data-toggle="tab" href="#connec">Activities</a></li>
                <li><a data-toggle="tab" href="#flow">Gallery</a></li>
                <!--<li><a data-toggle="tab" href="#flowing">Following (100)</a></li>-->
              </ul>

              <div class="sidebar tab-content">
                <!--<div class="sidebar">-->
                      <!--<h5 class="main-title">Participated Projects/Events/Activities</h5>-->
                      <div class="sidebar-information">

                        <div class="collapse-activities tab-pane fade in active" id="connec">
                          <div class="panel-group" id="accordion">
                        </div>
                        </div>

                          <div class="tab-pane fade" id="flow">
                              <div id="image-gallery-content">
                                  <div >
                                      <div class="img-item col-md-6">
                                          <img src="images/med-avatar.jpg" width="320px">
                                          <p>test image</p>
                                          <p class="uploaded-date">test image</p>
                                      </div>
                                      <div class="img-item col-md-6">
                                          <img src="images/med-avatar.jpg" width="320px">
                                          <p>test image</p>
                                          <p class="uploaded-date">test image</p>
                                      </div>
                                      <div class="img-item col-md-6">
                                          <img src="images/med-avatar.jpg" width="320px">
                                          <p>test image</p>
                                          <p class="uploaded-date">test image</p>
                                      </div>
                                      <div class="img-item col-md-6">
                                          <img src="images/med-avatar.jpg" width="320px">
                                          <p>test image</p>
                                          <p class="uploaded-date">test image</p>
                                      </div>
                                  </div>


                              </div>
                             <div id="pagination-container"></div>
                          </div>
                      </div>
                    </div>
              </div>

            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>

<div class="uou-block-4a secondary dark">
  <div class="container">
    <ul class="links">
      <li><a href="#">Privacy Policy</a></li>
      <li><a href="#">Terms &amp; Conditions</a></li>
    </ul>
    <p>Copyright &copy; 2015 <a href="#">UOUAPPS</a>. All Rights reserved.</p>
  </div>
</div>
<!-- end .uou-block-4a -->

<div class="uou-block-11a">
  <h5 class="title">Menu</h5>
  <a href="#" class="mobile-sidebar-close">&times;</a>
  <nav class="main-nav">
    <ul>
      <li><a href="index-2.html">Index</a></li>
      <li> <a href="listing-filter.html">Professionals</a> </li>
      <li><a href="profile_company.html">Profile Company</a></li>
      <li><a href="profile_company-no-tabs.html">Profile Company No Tabs</a></li>
      <li><a href="user-dashboard(connections)(hotkeys-disabled).html">User Dashboard 1</a></li>
      <li><a href="user-dashboard(connections)(hotkeys-enabled).html">User Dashboard 2</a></li>
      <li class="active"><a href="user-dashboard(followers).html">User Dashboard 3</a></li>
      <li><a href="user-dashboard(following).html">User Dashboard 4</a></li>
      <li><a href="blog-post.html">Blog Post</a></li>
      <li> <a href="user-profile(layout-1).html">User Profile</a></li>
      <li><a href="blog.html">Blog</a></li>
      <li><a href="gui-kit.html">GUI KIT</a></li>
    </ul>
  </nav>
  <hr>
</div> 

<!-- Scripts --> 
<script src="https://maps.googleapis.com/maps/api/js"></script> 
<script src="js/jquery-2.1.3.min.js"></script> 
<script src="js/bootstrap.js"></script> 
<script src="js/plugins/superfish.min.js"></script> 
<script src="js/jquery.ui.min.js"></script> 
<script src="js/plugins/rangeslider.min.js"></script> 
<script src="js/plugins/jquery.flexslider-min.js"></script> 
<script src="js/uou-accordions.js"></script> 
<script src="js/uou-tabs.js"></script> 
<script src="js/plugins/select2.min.js"></script> 
<script src="js/owl.carousel.min.js"></script> 
<script src="js/gmap3.min.js"></script> 
<script src="js/scripts.js"></script>
<script src="js/pagination.min.js"></script>

<script>
    localStorage.setItem('loggedUserId','se-2013-038')
  var projectId = 1;
  var url = 'http://localhost:8080/api/v1/project/getProjectDetails?projectId=' + projectId;
  fetch(url)
      .then(function(response) {
          return response.json();
      })
      .then(function(myJson) {
          var data = myJson.data;
          console.log(data)
          var startDate = new Date(data.userProjects[0].project.startDate)
          var endDate = new Date(data.userProjects[0].project.endDate)

          $("#startDate").html(startDate.toLocaleDateString())
          $("#endDate").html(endDate.toLocaleDateString())
          $("#projectName").html(data.userProjects[0].project.name)
          $("#description").html(data.userProjects[0].project.description)

          var ocMembersListHtml = '';
          data.userProjects.forEach(function (userProject) {
               var name = userProject.user.firstName + ' ' + userProject.user.lastName;
              if(userProject.userProjectRole === 'Team Leader'){
                  $("#teamLeader").html(name)
              }else {
                  ocMembersListHtml += '<li>' + name + '</li>';
              }
          })
          $("#ocMembers").html(ocMembersListHtml)
          renderActivities(data.activityUsers)
      });

    function doComment(activityId) {
        var id = '#comment' + activityId;
        var cmt = $(id).val();
        var userId = localStorage.getItem('loggedUserId');

        var comment = {
            comment: $(id).val(),
            activityId: activityId ,
            userId: userId
        };
        var url = 'http://localhost:8080/api/v1/activity/addComment';

        fetch(url, {
            method: 'POST', // or 'PUT'
            body: JSON.stringify(comment), // data can be `string` or {object}!
            headers:{
                'Content-Type': 'application/json'
            }
        }).then(res => res.json())
    .catch(error => console.error('Error:', error))
    .then((response) => {
            console.log('Success:', response)
        window.ns();
    });
        console.log(comment)
    }

  function renderActivities(activities) {
      var html = '';

      var index = 0;

      for(var activity of activities ){
          console.log(activity)
          var startDate = new Date(activity.activity.startDate).toLocaleDateString();
          var endDate = new Date(activity.activity.endDate).toLocaleDateString();
          var description = activity.activity.description;
          var activityId =  activity.activity.activityId;

          html+= ' <div class="panel panel-default"><div class="panel-heading">';
          html+= ' <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" href="#collapse'+index+'">';
          html+= 'Beach Cleanup</a></h4></div>'

          html+= '<div id="collapse'+index+'" class="panel-collapse collapse"><div class="panel-body"><ul class="list-group">';
          html+= '<li class="list-group-item">Participants: &nbsp';
          activity.users.forEach(function (user) {
              html+= '<span style="color:#898989;font-weight:bold">'+user.firstName+ ' ' + user.lastName+ '</span> | '
          })
          html+= '</li>';
          html+= '<li class="list-group-item">Start Date: &nbsp'+startDate+'</li>';
          html+= '<li class="list-group-item">End Date: &nbsp'+endDate+'</li>';
          html+= '<li class="list-group-item">Description: &nbsp'+description+'</li></ul><br><br>';
          activity.activity.activityComments.forEach(function (comment) {
              var user = comment.user.firstName;
              var dateTime = new Date(comment.dateTime);
              var description = comment.description;
              var profileImg = 'images/med-avatar.jpg';
              if(comment.user.profilePic !== null && comment.user.profilePic !== ""){
                  profileImg = 'data:image/png;base64, '+ comment.user.profilePic;
              }

              html+= '<div class="col-sm-2 text-center"><img src="'+profileImg+'" class="img-circle" height="65" width="65" alt="Avatar"></div>';
              html+= '<div class="col-sm-10">';
              html+= '<h5>'+ user +' <small>'+ dateTime +'</small></h5>';
              html+= '<p>'+ description +'</p><br></div>';
          });
          html+= '<div class="activity-comments">';
          html+= '<form><div class="form-group"><div class="col-md-10"><div class="form-group">'
          html+= '<textarea class="form-control" rows="1" id="comment'+activityId+'" placeholder="your comments"></textarea></div>';
          html+= '<div class="col-md-2"><button onclick="doComment(this.value)" value="'+ activityId +'" class="btn btn-success">Submit</button></div>';
          html+= '</div></form></div></div></div></div></div>';

          index++;
      }

      $("#accordion").html(html)
  }
  loadProjectComments();
  function loadProjectComments() {
      var getCommentUrl = 'http://localhost:8080/api/v1/project/getComments?projectId=' + projectId;
      fetch(getCommentUrl)
          .then(function(response) {
              return response.json();
          })
          .then(function(myJson) {
              console.log(myJson)
              var data = myJson.data;
              var commentsHtml = ''


              data.forEach(function (item) {
                  var userName = item.user.firstName;
                  var dateTime = new Date(item.dateTime).toLocaleString();
                  var cmt = item.description;
                  var img = 'images/med-avatar.jpg';
                  if(item.user.profilePic !== null && item.user.profilePic !== "" ){
                      img = 'data:image/png;base64, '+ item.user.profilePic;
                  }
                  commentsHtml += '<div class="col-sm-2 text-right">'
                  commentsHtml += '<img src="'+ img +'" class="img-circle" height="65" width="65" alt="Avatar"></div>'
                  commentsHtml += '<div class="col-sm-10">'
                  commentsHtml += '<h5>' + userName +' <small>' + dateTime + '</small></h5>'
                  commentsHtml += '<p>' + cmt + '</p></div>'
              })
              $('#projectCommentContainer').html(commentsHtml)

          });
  }

  $('#projectCommentBtn').on("click",function () {


      var id = projectId;
      var cmt = $('#projectComment').val();
      var userId = localStorage.getItem('loggedUserId');

      var comment = {
          comment: cmt,
          projectId: projectId ,
          userId: userId
      };
      var url = 'http://localhost:8080/api/v1/project/addComment';

      fetch(url, {
          method: 'POST', // or 'PUT'
          body: JSON.stringify(comment), // data can be `string` or {object}!
          headers:{
              'Content-Type': 'application/json'
          }
      }).then(res => res.json())
      .catch(error => console.error('Error:', error))
      .then((response) => {
          console.log('Success:', response)
      loadProjectComments();
  });
      console.log(comment)

  })


//  <div class="col-sm-2 text-right">
//      <img src="images/med-avatar.jpg" class="img-circle" height="65" width="65" alt="Avatar">
//      </div>
//      <div class="col-sm-10">
//      <h5>Anja <small>Sep 29, 2015, 9:12 PM</small></h5>
//  <p>good job!</p>
//  <br>
//  </div>


    $('#pagination-container').pagination({
//        dataSource: [1, 2, 3, 4, 5, 6, 7, 8,9,10,11,12,13,14,15],
        dataSource: function(done) {
            $.ajax({
                type: 'GET',
                url: 'http://localhost:8080/api/v1/project/getImages?projectId=' + projectId,
                success: function (response) {
                    var data = JSON.parse(response).data;
                    done(data);
                    console.log(data)
                }
            });
        },
        pageSize: 6,
        callback: function(data, pagination) {
            console.log(data)
            console.log(pagination)
            var html = simpleTemplating(data);
            $('#image-gallery-content').html(html);
        }
    });

    function simpleTemplating(data) {
        var html = '';

        data.forEach(function (image) {
            var imageData = "images/med-avatar.jpg";
            var description = image.description;
            var date = new Date(image.dateTime)
            if(image.image !== null && image.image !== "" ){
                imageData = 'data:image/png;base64, '+ image.image;
            }
            html += '<div class="img-item col-md-6">'
            html += '<img src="'+imageData+'" width="350px">'
            html += ' <p>'+description+'</p>';
            html += '<p class="uploaded-date">'+date.toLocaleString()+'</p> </div>'
        })

        return html;
    }

</script>

<!--collapse scripts-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

</body>

<!-- Mirrored from new.uouapps.com/tiger-html/user-dashboard(followers).html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 29 May 2018 08:12:17 GMT -->
</html>