<!doctype html>
<html lang="en">

<!-- Mirrored from new.uouapps.com/tiger-html/user-profile(layout-1).html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 29 May 2018 08:12:30 GMT -->
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>TIGER - Social Network HTML Template</title>

<!-- Fonts Online -->
<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700,800,300' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>

<!-- Style Sheet -->
<link rel="stylesheet" href="css/owl.carousel.css">
<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/main-style.css">
<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
  <style>
    .user-profile-bnr {
      min-height: 170px;
      background-size: unset;
    }
    .list-group-item{
      border: none;
    }
    .activity-item{
      margin-left: 10px;
    }
    .fa{
      font-size: x-small;
    }
    .list-group li{
      padding: 3px !important;
    }
    .comment-profile-img{
      width: 10%;
    }
    .comments{
      margin-top: 15px;
    }
    .comment-content{
      padding: 0px;
    }
    .comment-content h5{
      margin-top: 2px;
    }
    .comment-content p{
      margin-top: -10px;
    }

    #pagination-container ul {
      list-style-type: none;
      margin: 0;
      /*padding-left: 40px;*/
      overflow: hidden;
      background-color: #fff;
    }

    #pagination-container li {
      float: left;
      padding: 10px
    }
    .listing-inner input{
        color: black;
    }
  </style>
</head>

<body>
<div id="main-wrapper"> 

  
  <div class="box-shadow-for-ui">
    <div class="uou-block-2b">
      <div class="container"> <a href="#" class="logo"><img src="images/logo.png" alt=""></a> <a href="#" class="mobile-sidebar-button mobile-sidebar-toggle"><span></span></a>
        <nav class="nav">
          <ul class="sf-menu">
            <li><a href="index.html"><i class="fa  fa-home"></i></a></li>
            <li> <a href="listing-filter.html">Professionals</a> </li>
            <li> <a href="index-2.html">Pages</a>
              <ul>
                <li><a href="profile_company.html">Profile Company</a></li>
                <li><a href="profile_company-no-tabs.html">Profile Company No Tabs</a></li>
                <li><a href="user-dashboard(connections)(hotkeys-disabled).html">User Dashboard 1</a></li>
                <li><a href="user-dashboard(connections)(hotkeys-enabled).html">User Dashboard 2</a></li>
                <li><a href="user-dashboard(followers).html">User Dashboard 3</a></li>
                <li><a href="profile.html">User Dashboard 4</a></li>
                <li><a href="blog-post.html">Blog Post</a></li>                
              </ul>
            </li>
            <li class="active"> <a href="user-profile(layout-1).html">User Profile</a></li>
            <li><a href="blog.html">Blog</a></li>
            <li><a href="gui-kit.html">GUI KIT</a></li>
          </ul>
        </nav>
      </div>
    </div>
    <!-- end .uou-block-2b --> 
  </div>
  <!-- end .uou-block-2b -->
  
  <div class="compny-profile"> 
    <!-- SUB Banner -->
    <div class="profile-bnr user-profile-bnr">
      <div class="container">
        <div class="pull-left">
          <h2>User Profile</h2>
          <!--<h5>Front-End Developer</h5>-->
        </div>

         <!--Top Riht Button-->
        <!--<div class="right-top-bnr">-->
          <!--<div class="connect"> <a href="#." data-toggle="modal" data-target="#myModal"><i class="fa fa-user-plus"></i> Connect</a> <a href="#."><i class="fa fa-share-alt"></i> Share</a>-->
            <!--<div class="bt-ns"> <a href="#."><i class="fa fa-bookmark-o"></i> </a> <a href="#."><i class="fa fa-envelope-o"></i> </a> <a href="#."><i class="fa fa-exclamation"></i> </a> </div>-->
          <!--</div>-->
        <!--</div>-->
      </div>

    </div>
    
    <!-- Profile Company Content -->
    <div class="profile-company-content user-profile main-user" data-bg-color="f5f5f5">
      <div class="container">
        <div class="row"> 
          
          <!-- Nav Tabs -->
          <div class="col-md-12">
            <ul class="nav nav-tabs">
              <li class="active"><a data-toggle="tab" href="#profile">Profile</a></li>
              <li><a data-toggle="tab" href="#manage-account">Manage Account</a></li>

            </ul>
          </div>
          
          <!-- Tab Content -->
          <div class="col-md-12">
            <div class="tab-content"> 
              
              <!-- PROFILE -->
              <div id="profile" class="tab-pane fade in active">
                <div class="row">

                  <!-- SIDE BAR -->
                  <div class="col-md-4">
                    <!-- Company Information -->
                    <div class="sidebar">
                      <h5 class="main-title" id="username"></h5>
                      <div class="sidebar-thumbnail"> <img id="profile-pic" src="images/avatar1.jpg" alt=""> </div>
                      <div>
                        <p id="email" style="font-family: 'Montserrat', sans-serif;">hapakarunanayak@gmail.com</p>
                      </div>
                      <div class="sidebar-information">
                        <ul class="single-category">
                          <li class="row">
                            <h6 class="title col-xs-6">Contact No</h6>
                            <span class="subtitle col-xs-6" id="contact-no">-</span> </li>
                          <li class="row">
                            <h6 class="title col-xs-6">Hometown</h6>
                            <span class="subtitle col-xs-6" id="hometown">-</span> </li>
                          <li class="row">
                            <h6 class="title col-xs-6">Current Position</h6>
                            <span class="subtitle col-xs-6" id="position">Member</span> </li>
                        </ul>
                        <div>
                          <span style="font-size: small; font-family: 'Montserrat', sans-serif; color: #999999;" id="description">No Profile data</span>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Tab Content -->
                  <div class="col-md-8">
                    <div class="network">
                      <div class="sidebar">
                        <!--<h5 class="main-title">Participated Projects/Events/Activities</h5>-->
                        <h4 class="main-title">Projects</h4>
                        <div class="sidebar-information">

                          <div class="collapse-activities">
                            <div class="panel-group" id="accordion">
                              <div class="panel panel-default">
                                <div class="panel-heading">
                                  <h4 class="panel-title">
                                    <a data-toggle="collapse" data-parent="#accordion" href="#collapse1">Go Green 9.1</a>
                                  </h4>
                                </div>
                                <div id="collapse1" class="panel-collapse collapse in">
                                  <div class="panel-body">
                                    <ul class="list-group">
                                      <li class="list-group-item">
                                        <i class="fa fa-circle"></i><span class="activity-item">Team Leader</span>
                                        <div class="comments">
                                          <div class="comment row">
                                            <div class="col-sm-2 text-center comment-profile-img">
                                              <img src="images/avatar1.jpg" class="img-circle" height="65" width="65" alt="Avatar">
                                            </div>
                                            <div class="col-sm-10 comment-content">
                                              <h5>Anja <small>Sep 29, 2015, 9:12 PM</small></h5>
                                              <p>good job!</p>
                                            </div>
                                          </div>
                                        </div>
                                        <div class="form-group">
                                          <div class="col-md-10">
                                            <textarea class="form-control" rows="1" id="comment" placeholder="your comments"></textarea>
                                          </div>
                                          <div class="col-md-2">
                                            <button type="submit" class="btn btn-success">Submit</button>
                                          </div>
                                        </div>
                                        <hr>
                                      </li>
                                      <li class="list-group-item"><i class="fa fa-circle"></i><span class="activity-item">Raised Wise International School Kadhana</span></li>
                                      <li class="list-group-item"><i class="fa fa-circle"></i><span class="activity-item">Organized beach cleabup at panadura beach</span></li>
                                    </ul>
                                    <hr>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div id="pagination-container">

                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Manage Account -->
              <div id="manage-account" class="tab-pane fade">

                <div class="listing listing-1">
                  <div class="col-md-12" style="margin-bottom: 25px;">
                    <div class="col-md-4">
                      <img id="profile-pic-change" src="images/avatar.jpg" style="height: 300px; width: 300px;">
                    </div>
                    <div class="col-md-4">
                      <button class="btn btn-primary"><a style="color: white" href="image-uploader.html">Change image</a></button>
                    </div>
                  </div>

                  <div class="listing-section">
                    <div class="listing-ver-3">

                      <div class="listing-inner">


                        <div class="col-md-6" >
                          <div class="form-group">
                            <label class="col-md-4 control-label" for="studentId">Student No</label>
                            <div class="col-md-8">
                              <input id="studentId" name="studentId" type="text" class="form-control input-md" disabled>
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-md-4 control-label" for="firstName">First name</label>
                            <div class="col-md-8">
                              <input id="firstName" name="firstName" type="text" placeholder="First name here" class="form-control input-md">
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-md-4 control-label" for="lastName">Last name</label>
                            <div class="col-md-8">
                              <input id="lastName" name="lastName" type="text" placeholder="Last name here" class="form-control input-md">
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-md-4 control-label" for="user-email">Email</label>
                            <div class="col-md-8">
                              <input id="user-email" name="user-email" type="email" placeholder="Email here" class="form-control input-md">
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-md-4 control-label" for="contactNo">Contact No</label>
                            <div class="col-md-8">
                              <input id="contactNo" name="contactNo" type="tel" placeholder="Contact no here" class="form-control input-md">
                            </div>
                          </div>

                        </div>

                        <div class="col-md-6" >
                          <div class="form-group">
                            <label class="col-md-4 control-label" for="address">Address</label>
                            <div class="col-md-8">
                              <input id="address" name="address" type="text" placeholder="Address here" class="form-control input-md">
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-md-4 control-label" for="user-hometown">Hometown</label>
                            <div class="col-md-8">
                              <input id="user-hometown" name="user-hometown" type="text" placeholder="Hometown here" class="form-control input-md">
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-md-4 control-label" for="dob">Date of Birth</label>
                            <div class="col-md-8">
                              <input id="dob" name="dob" type="date" placeholder="Date of Birth here" class="form-control input-md">
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-md-4 control-label" for="user-description">Description</label>
                            <div class="col-md-8">
                              <input id="user-description" name="user-description" type="text" placeholder="Description here" class="form-control input-md">
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-md-4 control-label" for="user-position">Position</label>
                            <div class="col-md-8">
                              <select id="user-position" name="user-position" class="form-control">
                                <option value="Team Leader">Team Leader</option>
                                <option value="OC">OC</option>
                                <option value="Member">Member</option>
                              </select>
                            </div>
                          </div>
                        </div>
                          <div style="float: right; padding: 30px;">
                            <button id="saveBtn" class="btn btn-success">Save Changes</button>
                          </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



<div class="uou-block-4a secondary dark">
  <div class="container">
    <ul class="links">
      <li><a href="#">Privacy Policy</a></li>
      <li><a href="#">Terms &amp; Conditions</a></li>
    </ul>
    <p>Copyright &copy; 2015 <a href="#">UOUAPPS</a>. All Rights reserved.</p>
  </div>
</div>
<!-- end .uou-block-4a --> 

<div class="uou-block-11a">
  <h5 class="title">Menu</h5>
  <a href="#" class="mobile-sidebar-close">&times;</a>
  <nav class="main-nav">
    <ul>
      <li><a href="index-2.html">Index</a></li>
      <li><a href="listing-filter.html">Professionals</a> </li>
      <li><a href="profile_company.html">Profile Company</a></li>
      <li><a href="profile_company-no-tabs.html">Profile Company No Tabs</a></li>
      <li><a href="user-dashboard(connections)(hotkeys-disabled).html">User Dashboard 1</a></li>
      <li><a href="user-dashboard(connections)(hotkeys-enabled).html">User Dashboard 2</a></li>
      <li><a href="user-dashboard(followers).html">User Dashboard 3</a></li>
      <li><a href="profile.html">User Dashboard 4</a></li>
      <li><a href="blog-post.html">Blog Post</a></li>
      <li class="active"><a href="user-profile(layout-1).html">User Profile</a></li>
      <li><a href="blog.html">Blog</a></li>
      <li><a href="gui-kit.html">GUI KIT</a></li>
    </ul>
  </nav>
  <hr>
</div>

<!-- Scripts --> 
<script src="https://maps.googleapis.com/maps/api/js"></script> 
<script src="js/jquery-2.1.3.min.js"></script> 
<script src="js/bootstrap.js"></script> 
<script src="js/plugins/superfish.min.js"></script> 
<script src="js/jquery.ui.min.js"></script> 
<script src="js/plugins/rangeslider.min.js"></script> 
<script src="js/plugins/jquery.flexslider-min.js"></script> 
<script src="js/uou-accordions.js"></script> 
<script src="js/uou-tabs.js"></script> 
<script src="js/plugins/select2.min.js"></script> 
<script src="js/owl.carousel.min.js"></script> 
<script src="js/gmap3.min.js"></script> 
<script src="js/scripts.js"></script>
<script src="js/pagination.min.js"></script>
<script>
$(function () {
  $('[data-toggle="tooltip"]').tooltip()
})
</script>

<script>
    localStorage.setItem('loggedUserId','se-2013-038')

    function doComment(activityId) {
        var id = '#comment' + activityId;
        var cmt = $(id).val();
        var userId = localStorage.getItem('loggedUserId');

        var comment = {
            comment: $(id).val(),
            activityId: activityId ,
            userId: userId
        };
        var url = 'http://localhost:8080/api/v1/activity/addComment';

        fetch(url, {
            method: 'POST', // or 'PUT'
            body: JSON.stringify(comment), // data can be `string` or {object}!
            headers:{
                'Content-Type': 'application/json'
            }
        }).then(res => res.json())
    .catch(error => console.error('Error:', error))
    .then((response) => {
            console.log('Success:', response)
        window.ns();
    });
        console.log(comment)
    }

    $( function() {
        var userId = localStorage.getItem('loggedUserId');
        var profile = localStorage.getItem('loggedUser');
        function getUserData(){
            fetch('http://localhost:8080/api/v1/user/getUser?studentId='+ userId)
                .then(function(response) {
                    return response.json();
                })
                .then(function(myJson) {
                    console.log(myJson);
                    profile = myJson.data;
                    console.log(profile);
                    renderProfileData(profile);

                });
        }
        getUserData();

        function renderProfileData(profile) {

            $("#username").html(  profile.firstName + ' ' + profile.lastName ) ;
            $("#email").html(  profile.email ) ;
            $("#hometown").html(  profile.hometown ) ;
            $("#description").html(  profile.description ) ;
            $("#contact-no").html(  profile.tel ) ;
            if(profile.position !== null && profile.position !== ""){
                $("#position").html(  profile.position ) ;
            }
            if(profile.profilePic !== null && profile.profilePic !== "" ){
                var img = 'data:image/png;base64, '+ profile.profilePic;
                $("#profile-pic").attr("src", img);
                var imgToUpload = localStorage.getItem('imageStringToUpload');
                if(imgToUpload !== null){
                    $("#profile-pic-change").attr("src", imgToUpload);
                }else{
                    $("#profile-pic-change").attr("src", img);
                }

            }

            var dob = new Date(profile.dob);

            var day = ("0" + dob.getDate()).slice(-2);
            var month = ("0" + (dob.getMonth() + 1)).slice(-2);

            var _dob = dob.getFullYear()+"-"+(month)+"-"+(day) ;

            $('#dob').val(_dob)

            $("#studentId").val(profile.studentId)
            $("#user-email").val(profile.email)
            $("#firstName").val(profile.firstName)
            $("#lastName").val(profile.lastName)
            $("#contactNo").val(profile.tel)
            $("#user-hometown").val(profile.hometown)
            $("#address").val(profile.address)
//            $("#dob").val(dob)
            $("#user-description").val(profile.description)
            $("#user-position").val(profile.position)

            window.ns();
        }




//        start();
        window.ns = function () {
            $('#pagination-container').pagination({
//        dataSource: [1, 2, 3, 4, 5, 6, 7, 8,9,10,11,12,13,14,15],
                dataSource: function(done) {
                    $.ajax({
                        type: 'GET',
                        url: 'http://localhost:8080/api/v1/project/getProjectUserDetails?studentId=' + profile.studentId,
                        success: function (response) {
                            var data = JSON.parse(response).data;
                            done(data);
                            console.log(data)
                        }
                    });
                },
                pageSize: 8,
                callback: function(data, pagination) {
                    console.log(data)
                    console.log(pagination)
                    var html = simpleTemplating(data);
                    $('#accordion').html(html);
                }
            });
        }

        function simpleTemplating(data) {
//            console.log(data)
            var html = '';
            $.each(data, function(index, item){

                var projectName = item.userProject.project.name;

                html += '<div class="panel panel-default"><div class="panel-heading"><h4 class="panel-title">';
                html += '<a data-toggle="collapse" data-parent="#accordion" href="#collapse' + index +'"'+'>' + projectName + '</a></h4></div>';
                html += '<div id=collapse' + index + ' class="panel-collapse collapse">';
                html += '<div class="panel-body"><ul class="list-group">';

                item.activities.forEach(function (activity) {
                    var  activityComments = activity.activityComments;
                    var activityId = activity.activityId;

                    html += '<li class="list-group-item"><i class="fa fa-circle"></i><span class="activity-item">'+ activity.name +'</span><div class="comments">';
                    activityComments.forEach(function (comment) {
                        var profileImg = 'images/avatar1.jpg';
                        var description = comment.description;
                        var commentDate = new Date(comment.dateTime).toLocaleString();
                        var commentUsername = comment.user.firstName;

                        if(comment.user.profilePic !== null && comment.user.profilePic !== ""){
                            profileImg = 'data:image/png;base64, '+ comment.user.profilePic;
                        }

                        html += '<div class="comment row"><div class="col-sm-2 text-center comment-profile-img">';
                        html += '<img src="'+ profileImg +'" class="img-circle" height="65" width="65" alt="Avatar"></div>'
                        html += '<div class="col-sm-10 comment-content">';
                        html += '<h5>' + commentUsername + ' <small>'+ commentDate +'</small></h5>';
                        html += '<p>' + description + '</p></div></div>'
                    });

                    html += '<div class="form-group"><div class="col-md-10">';
                    html += '<textarea class="form-control" rows="1" id="comment'+activityId+'" placeholder="Enter your comment here"></textarea>'
                    html += '</div><div class="col-md-2">';
                    html += '<button onclick="doComment(this.value)" value="'+ activityId +'" class="btn btn-success">Submit</button>'
                    html += '</div></div>';

                    html += '</div></li><br><hr>'
                });
                html += '</ul><hr>';


                html += '</div></div></div>'
            });
            return html;
        }

        $( "#saveBtn" ).on( "click", function() {
            var studentId = $("#studentId").val()
            var email =  $("#user-email").val()
            var firstName = $("#firstName").val()
            var lastName = $("#lastName").val()
            var tel = $("#contactNo").val()
            var hometown = $("#user-hometown").val()
            var address = $("#address").val()
            var dob = $("#dob").val()
            var description = $("#user-description").val()
            var position = $("#user-position").val()
            var newProfilePic = localStorage.getItem('imageStringToUpload');
            var profilePic = null;
            if(newProfilePic !== null){
                profilePic = newProfilePic.split(',')[1];
            }

            var user = {
                studentId: studentId,
                email: email,
                firstName: firstName,
                lastName: lastName,
                tel: tel,
                description: description,
                hometown: hometown,
                address: address,
                dob: dob,
                position: position,
                profilePic: profilePic
            }

            var url = 'http://localhost:8080/api/v1/user/updateUser';

            fetch(url, {
                method: 'POST', // or 'PUT'
                body: JSON.stringify(user), // data can be `string` or {object}!
                headers:{
                    'Content-Type': 'application/json'
                }
            }).then(res => res.json())
            .catch(error => console.error('Error:', error))
            .then((response) => {
                console.log('Success:', response)
                localStorage.removeItem('imageStringToUpload');
                alert("Data updated successfully")
            getUserData();
        });

            console.log(user)
        });
    } );

    window.onbeforeunload = function (e) {
        localStorage.removeItem('imageStringToUpload');
    };

</script>
</body>

<!-- Mirrored from new.uouapps.com/tiger-html/user-profile(layout-1).html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 29 May 2018 08:13:14 GMT -->
</html>